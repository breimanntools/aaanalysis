

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>CPP Module &mdash; AAanalysis 2023 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/plot_directive.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="dpulearn.html" />
    <link rel="prev" title="AAclust Module" href="aaclust.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> AAanalysis
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="aaclust.html">AAclust Module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">CPP Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#aaanalysis.cpp.CPP"><code class="docutils literal notranslate"><span class="pre">CPP</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.CPP.add_positions"><code class="docutils literal notranslate"><span class="pre">CPP.add_positions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.CPP.add_sample_dif"><code class="docutils literal notranslate"><span class="pre">CPP.add_sample_dif()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.CPP.add_shap"><code class="docutils literal notranslate"><span class="pre">CPP.add_shap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.CPP.plot_heatmap"><code class="docutils literal notranslate"><span class="pre">CPP.plot_heatmap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.CPP.plot_profile"><code class="docutils literal notranslate"><span class="pre">CPP.plot_profile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.CPP.run"><code class="docutils literal notranslate"><span class="pre">CPP.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#aaanalysis.cpp.SequenceFeature"><code class="docutils literal notranslate"><span class="pre">SequenceFeature</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.SequenceFeature.feat_matrix"><code class="docutils literal notranslate"><span class="pre">SequenceFeature.feat_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.SequenceFeature.feat_names"><code class="docutils literal notranslate"><span class="pre">SequenceFeature.feat_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.SequenceFeature.feat_value"><code class="docutils literal notranslate"><span class="pre">SequenceFeature.feat_value()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.SequenceFeature.features"><code class="docutils literal notranslate"><span class="pre">SequenceFeature.features()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.SequenceFeature.get_df_parts"><code class="docutils literal notranslate"><span class="pre">SequenceFeature.get_df_parts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.SequenceFeature.get_split_kws"><code class="docutils literal notranslate"><span class="pre">SequenceFeature.get_split_kws()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#aaanalysis.cpp.SplitRange"><code class="docutils literal notranslate"><span class="pre">SplitRange</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.SplitRange.labels_pattern"><code class="docutils literal notranslate"><span class="pre">SplitRange.labels_pattern()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.SplitRange.labels_periodicpattern"><code class="docutils literal notranslate"><span class="pre">SplitRange.labels_periodicpattern()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.SplitRange.labels_segment"><code class="docutils literal notranslate"><span class="pre">SplitRange.labels_segment()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.SplitRange.pattern"><code class="docutils literal notranslate"><span class="pre">SplitRange.pattern()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.SplitRange.periodicpattern"><code class="docutils literal notranslate"><span class="pre">SplitRange.periodicpattern()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaanalysis.cpp.SplitRange.segment"><code class="docutils literal notranslate"><span class="pre">SplitRange.segment()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AAanalysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>CPP Module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/cpp.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-aaanalysis.cpp">
<span id="cpp-module"></span><h1>CPP Module<a class="headerlink" href="#module-aaanalysis.cpp" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="aaanalysis.cpp.CPP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aaanalysis.cpp.</span></span><span class="sig-name descname"><span class="pre">CPP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_cat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_parts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_gaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_n_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_c_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/cpp.html#CPP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.CPP" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and filter features that are most discriminant between two sets of sequences.</p>
<div class="section" id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>df_scales<span class="classifier">pd.DataFrame, default=aa.load_scales(name=ut.STR_SCALE_CAT)</span></dt><dd><p>DataFrame with default amino acid scales.</p>
</dd>
<dt>df_cat<span class="classifier">pd.DataFrame, default=aa.load_categories</span></dt><dd><p>DataFrame with default categories for physicochemical amino acid scales.</p>
</dd>
<dt>df_parts<span class="classifier">pd.DataFrame</span></dt><dd><p>DataFrame with sequence parts.</p>
</dd>
<dt>split_kws<span class="classifier">dict, default=SequenceFeature.get_split_kws</span></dt><dd><p>Nested dictionary with parameter dictionary for each chosen split_type.</p>
</dd>
<dt>accept_gaps<span class="classifier">bool, default=False</span></dt><dd><p>Whether to accept missing values by enabling omitting for computations (if True).</p>
</dd>
<dt>jmd_n_len<span class="classifier">int, &gt;=0, default=10</span></dt><dd><p>Length of JMD-N.</p>
</dd>
<dt>jmd_c_len<span class="classifier">int, &gt;=0, default=10</span></dt><dd><p>Length of JMD-C.</p>
</dd>
<dt>ext_len<span class="classifier">int, &gt;=0, default=4</span></dt><dd><p>Length of TMD-extending part (starting from C and N terminal part of TMD).
Conditions: ext_len &lt; jmd_m_len and ext_len &lt; jmd_c_len.</p>
</dd>
<dt>verbose<span class="classifier">bool, default=True</span></dt><dd><p>Whether to print progress information about the algorithm (if True).</p>
</dd>
</dl>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this heading">¶</a></h2>
<p>The CPP.run() method performs all steps of the CPP algorithm.</p>
<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.CPP.add_positions">
<span class="sig-name descname"><span class="pre">add_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmd_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/cpp.html#CPP.add_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.CPP.add_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Add sequence positions to DataFrame.</p>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>df_feat: pd.DataFrame</dt><dd><p>Feature DataFrame to add feature positions.</p>
</dd>
<dt>tmd_len: int, &gt;0</dt><dd><p>Length of TMD.</p>
</dd>
<dt>start: int, &gt;=0</dt><dd><p>Position label of first amino acid position (starting at N-terminus).</p>
</dd>
</dl>
</div>
<div class="section" id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>df_feat: pd.DataFrame</dt><dd><p>Feature DataFrame including feature positions.</p>
</dd>
</dl>
</div>
<div class="section" id="id1">
<h3>Notes<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<p>The length parameters define the total number of positions (jmd_n_len + tmd_len + jmd_c_len).</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.CPP.add_sample_dif">
<span class="sig-name descname"><span class="pre">add_sample_dif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_feat=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_seq=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_name=&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_group=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_gaps=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/cpp.html#CPP.add_sample_dif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.CPP.add_sample_dif" title="Permalink to this definition">¶</a></dt>
<dd><p>Add feature value difference between sample and reference group to DataFrame.</p>
<div class="section" id="id2">
<h3>Parameters<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>df_feat: pd.DataFrame</dt><dd><p>Feature DataFrame to add sample difference.</p>
</dd>
<dt>df_seq: pd.DataFrame</dt><dd><p>DataFrame with sequences and sample names, in which the given sample name is included.</p>
</dd>
<dt>labels: array-like, shape (n_samples)</dt><dd><p>Class labels for samples in sequence DataFrame.</p>
</dd>
<dt>sample_name: str</dt><dd><p>Name of sample for which the feature value difference to a given reference group should be computed.</p>
</dd>
<dt>ref_group: int, default=0</dt><dd><p>Class label of reference group.</p>
</dd>
<dt>accept_gaps: bool, default=False</dt><dd><p>Whether to accept missing values by enabling omitting for computations (if True).</p>
</dd>
</dl>
</div>
<div class="section" id="id3">
<h3>Returns<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>df_feat: pd.DataFrame</dt><dd><p>Feature DataFrame including feature value difference.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.CPP.add_shap">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_shap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_shap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'shap_value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_feat_impact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'feat_impact'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/cpp.html#CPP.add_shap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.CPP.add_shap" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert SHAP values in feature impact/importance and add to DataFrame.</p>
<div class="section" id="id4">
<h3>Parameters<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>df_feat: pd.DataFrame</dt><dd><p>Feature DataFrame to add feature impact.</p>
</dd>
<dt>col_shap: str, default=’shap_value’</dt><dd><p>Column name of (<a class="reference external" href="https://shap.readthedocs.io/en/latest/index.html">SHAP</a>) values in feature DataFrame</p>
</dd>
<dt>name_feat_impact: str, default=’feat_impact’</dt><dd><p>Column name of feature impact or feature importance that should be added to feature DataFrame.</p>
</dd>
</dl>
</div>
<div class="section" id="id5">
<h3>Returns<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>df_feat: pd.DataFrame</dt><dd><p>Feature DataFrame including feature impact.</p>
</dd>
</dl>
</div>
<div class="section" id="id6">
<h3>Notes<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>SHAP (SHapley Additive exPlanations) is a game theoretic approach to explain the output of</p></li>
</ul>
<p>any machine learning model.</p>
<ul class="simple">
<li><p>SHAP values represent a feature´s responsibility for a change in the model output.</p></li>
<li><p>Missing values are accepted in SHAP values.</p></li>
</ul>
</div>
<div class="section" id="see-also">
<h3>See also<a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h3>
<p>(<a class="reference external" href="https://shap.readthedocs.io/en/latest/index.html">SHAP</a>)</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.CPP.plot_heatmap">
<span class="sig-name descname"><span class="pre">plot_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'subcategory'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean_dif'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdBu_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_n_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">facecolor_dark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_jmd_tmd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmd_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_n_seq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmd_seq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_c_seq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmd_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mediumspringgreen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmd_seq_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_seq_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmd_jmd_fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xticks_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtick_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtick_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtick_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytick_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_legend_cat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_importance_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/cpp.html#CPP.plot_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.CPP.plot_heatmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a heatmap of the selected value column with scale information (y-axis) versus sequence position (x-axis).
This is a wrapper function for <code class="xref py py-func docutils literal notranslate"><span class="pre">seaborn.heatmap()</span></code>, designed to highlight differences between two sets
of sequences at the positional level (e.g., amino acid level for protein sequences).</p>
<div class="section" id="id7">
<h3>Parameters<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h3>
<dl>
<dt>df_feat<span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>, shape (n_feature, n_feature_information)</span></dt><dd><p>DataFrame containing unique identifiers, scale information, statistics, and positions for each feature.</p>
</dd>
<dt>y<span class="classifier">{‘category’, ‘subcategory’, ‘scale_name’}, str, default=’subcategory’</span></dt><dd><p>Name of the column in the feature DataFrame representing scale information (shown on the y-axis).</p>
</dd>
<dt>val_col<span class="classifier">{‘mean_dif’, ‘feat_impact’, ‘abs_auc’, ‘std_test’, …}, str, default=’mean_dif’</span></dt><dd><p>Name of the column in the feature DataFrame containing numerical values to display.</p>
</dd>
<dt>val_type<span class="classifier">{‘mean’, ‘sum’, ‘std’}, str, default=’mean’</span></dt><dd><p>Method to aggregate numerical values from ‘val_col’.</p>
</dd>
<dt>normalize<span class="classifier">{True, False, ‘positions’, ‘positions_only’}, bool/str, default=False</span></dt><dd><p>Specifies normalization for numerical values in ‘val_col’:</p>
<ul class="simple">
<li><p>False: Set value at all positions of a feature without further normalization.</p></li>
<li><p>True: Set value at all positions of a feature and normalize across all features.</p></li>
<li><p>‘positions’: Value/number of positions set at each position of a feature and normalized across features.
Recommended when aiming to emphasize features with fewer positions using ‘val_col’=’feat_impact’ and ‘value_type’=’mean’.</p></li>
</ul>
</dd>
<dt>figsize<span class="classifier">tuple(float, float), default=(10,7)</span></dt><dd><p>Width and height of the figure in inches passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.figure()</span></code>.</p>
</dd>
<dt>title<span class="classifier">str, optional</span></dt><dd><p>Title of figure used by <code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.title()</span></code>.</p>
</dd>
<dt>title_kws<span class="classifier">dict, optional</span></dt><dd><p>Keyword arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.title()</span></code>.</p>
</dd>
<dt>vmin, vmax<span class="classifier">float, optional</span></dt><dd><p>Values to anchor the colormap, otherwise, inferred from data and other keyword arguments.</p>
</dd>
<dt>cmap<span class="classifier">matplotlib colormap name or object, or list of colors, default=’seismic’</span></dt><dd><p>Name of color map assigning data values to color space. If ‘SHAP’, colors from
(<a class="reference external" href="https://shap.readthedocs.io/en/latest/index.html">SHAP</a>) will be used (recommended for feature impact).</p>
</dd>
<dt>cmap_n_colors<span class="classifier">int, optional</span></dt><dd><p>Number of discrete steps in diverging or sequential color map.</p>
</dd>
<dt>dict_color<span class="classifier">dict, optional</span></dt><dd><p>Map of colors for scale categories classifying scales shown on y-axis.</p>
</dd>
<dt>cbar_kws<span class="classifier">dict of key, value mappings, optional</span></dt><dd><p>Keyword arguments for <code class="xref py py-meth docutils literal notranslate"><span class="pre">matplotlib.figure.Figure.colorbar()</span></code>.</p>
</dd>
<dt>add_jmd_tmd<span class="classifier">bool, default=True</span></dt><dd><p>Whether to add colored bar under heatmap indicating sequence parts (JMD-N, TMD, JMD-C).</p>
</dd>
<dt>tmd_len<span class="classifier">int, &gt;0</span></dt><dd><p>Length of TMD to be depiceted.</p>
</dd>
<dt>start<span class="classifier">int, &gt;=0</span></dt><dd><p>Position label of first amino acid position (starting at N-terminus).</p>
</dd>
<dt>tmd_seq<span class="classifier">str, optional</span></dt><dd><p>Sequence of TMD. ‘tmd_len’ is set to length of TMD if sequence for TMD, JMD-N and JMD-C are given.
Recommended if feature impact or mean difference should be depicted for one sample.</p>
</dd>
<dt>jmd_n_seq<span class="classifier">str, optional</span></dt><dd><p>Sequence of JMD_N. ‘jmd_n_len’ is set to length of JMD_N if sequence for TMD, JMD-N and JMD-C are given.
Recommended if feature impact or mean difference should be depicted for one sample.</p>
</dd>
<dt>jmd_c_seq<span class="classifier">str, optional</span></dt><dd><p>Sequence of JMD_C. ‘jmd_c_len’ is set to length of JMD_C if sequence for TMD, JMD-N and JMD-C are given.
Recommended if feature impact or mean difference should be depicted for one sample.</p>
</dd>
<dt>tmd_color<span class="classifier">str, default=’mediumspringgreen’</span></dt><dd><p>Color of TMD bar.</p>
</dd>
<dt>jmd_color<span class="classifier">str, default=’blue’</span></dt><dd><p>Color of JMD-N and JMD-C bar.</p>
</dd>
<dt>tmd_seq_color<span class="classifier">str, default=’black’</span></dt><dd><p>Color of TMD sequence.</p>
</dd>
<dt>jmd_seq_color<span class="classifier">str, defaault=’white’</span></dt><dd><p>Color of JMD-N and JMD-C sequence.</p>
</dd>
<dt>seq_size<span class="classifier">float, optional</span></dt><dd><p>Font size of all sequence parts in points. If None, optimized automatically.</p>
</dd>
<dt>tmd_jmd_fontsize<span class="classifier">float, optional</span></dt><dd><p>Font size of ‘TMD’, ‘JMD-N’ and ‘JMD-C’  label in points. If None, optimized automatically.</p>
</dd>
<dt>xtick_size<span class="classifier">float, default=11.0</span></dt><dd><p>Size of x ticks in points. Passed as ‘size’ argument to <code class="xref py py-meth docutils literal notranslate"><span class="pre">matplotlib.axes.Axes.set_xticklabels()</span></code>.</p>
</dd>
<dt>xtick_width<span class="classifier">float, default=2.0</span></dt><dd><p>Widht of x ticks in points. Passed as ‘width’ argument to <code class="xref py py-meth docutils literal notranslate"><span class="pre">matplotlib.axes.Axes.tick_params()</span></code>.</p>
</dd>
<dt>xtick_length<span class="classifier">float, default=5.0,</span></dt><dd><p>Length of x ticks in points. Passed as ‘length’ argument to <code class="xref py py-meth docutils literal notranslate"><span class="pre">matplotlib.axes.Axes.tick_params()</span></code>.</p>
</dd>
<dt>ytick_size<span class="classifier">float, optional</span></dt><dd><p>Size of scale information as y ticks in points. Passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">matplotlib.axes.Axes.tick_params()</span></code>.
If None, optimized automatically.</p>
</dd>
<dt>add_legend_cat<span class="classifier">bool, default=True,</span></dt><dd><p>Whether to add legend for categories under plot and classification of scales at y-axis.</p>
</dd>
<dt>legend_kws<span class="classifier">dict, optional</span></dt><dd><p>Keyword arguments passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">matplotlib.axes.Axes.legend()</span></code></p>
</dd>
<dt>kwargs<span class="classifier">other keyword arguments</span></dt><dd><p>All other keyword arguments passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">matplotlib.axes.Axes.pcolormesh()</span></code>.</p>
</dd>
</dl>
</div>
<div class="section" id="id8">
<h3>Returns<a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h3>
<p>ax : matplotlib Axes
Axes object containing the heatmap.</p>
</div>
<div class="section" id="warning">
<h3>Warning<a class="headerlink" href="#warning" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>‘cmap_n_colors’ is effective only if ‘vmin’ and ‘vmax’ align with the data.</p></li>
<li><p>‘tmd_seq_color’ and ‘jmd_seq_color’ are applicable only when ‘tmd_seq’, ‘jmd_n_seq’, and ‘jmd_c_seq’ are provided.</p></li>
</ul>
</div>
<div class="section" id="id9">
<h3>See Also<a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h3>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">seaborn.heatmap()</span></code>
<a class="reference external" href="https://shap.readthedocs.io/en/latest/index.html">SHAP</a></p>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h3>
<p>Plot CPP feature heatmap:</p>
<p>(<a class="reference external" href=".//cpp-1.py">Source code</a>)</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.CPP.plot_profile">
<span class="sig-name descname"><span class="pre">plot_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_feat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'category'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean_dif'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'count'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bar_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_jmd_tmd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmd_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_n_seq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmd_seq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_c_seq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmd_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mediumspringgreen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmd_seq_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_seq_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmd_jmd_fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtick_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtick_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtick_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xticks_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytick_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytick_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytick_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight_tmd_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_legend_cat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shap_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/cpp.html#CPP.plot_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.CPP.plot_profile" title="Permalink to this definition">¶</a></dt>
<dd><div class="section" id="id10">
<h3>Parameters<a class="headerlink" href="#id10" title="Permalink to this heading">¶</a></h3>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.CPP.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parametric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmd_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_cat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pre_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pct_pre_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_std_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_processes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/cpp.html#CPP.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.CPP.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform CPP pipeline by creation and two-step filtering of features. CPP aims to
identify a collection of non-redundant features that are most discriminant between
a test and a reference group of sequences.</p>
<div class="section" id="id11">
<h3>Parameters<a class="headerlink" href="#id11" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>labels<span class="classifier">array-like, shape (n_samples)</span></dt><dd><p>Class labels for samples in sequence DataFrame (test=1, reference=0).</p>
</dd>
<dt>parametric<span class="classifier">bool, default=False</span></dt><dd><p>Whether to use parametric (T-test) or non-parametric (U-test) test for p-value computation.</p>
</dd>
<dt>n_filter<span class="classifier">int, default=100</span></dt><dd><p>Number of features to be filtered/selected by CPP algorithm.</p>
</dd>
<dt>n_pre_filter<span class="classifier">int, optional</span></dt><dd><p>Number of feature to be pre-filtered by CPP algorithm. If None, a percentage of all features is used.</p>
</dd>
<dt>tmd_len<span class="classifier">int, &gt;0</span></dt><dd><p>Length of Transmembrane Domain (TMD) used for positions.</p>
</dd>
<dt>start<span class="classifier">int, &gt;=0</span></dt><dd><p>Position label of first amino acid position (starting at N-terminus).</p>
</dd>
<dt>check_cat<span class="classifier">bool, default=True</span></dt><dd><p>Whether to check for redundancy within scale categories.</p>
</dd>
<dt>pct_pre_filter<span class="classifier">int, default=5</span></dt><dd><p>Percentage of all features that should remain after the pre-filtering step.</p>
</dd>
<dt>max_std_test<span class="classifier">float [0-1], default=0.2</span></dt><dd><p>Maximum standard deviation within the test group used as threshold for pre-filtering.</p>
</dd>
<dt>max_overlap<span class="classifier">float [0-1], default=0.5</span></dt><dd><p>Maximum positional overlap of features used as threshold for filtering.</p>
</dd>
<dt>max_cor<span class="classifier">float [0-1], default=0.5</span></dt><dd><p>Maximum Pearson correlation of features used as threshold for filtering.</p>
</dd>
<dt>n_processes<span class="classifier">int, default=None</span></dt><dd><p>Number of CPUs used for multiprocessing. If None, number will be optimized automatically.</p>
</dd>
</dl>
</div>
<div class="section" id="id12">
<h3>Returns<a class="headerlink" href="#id12" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>df_feat<span class="classifier">pd.DataFrame, shape (n_feature, n_feature_information)</span></dt><dd><p>DataFrame with a unique identifier, scale information, statistics, and positions for each feature.</p>
</dd>
</dl>
</div>
<div class="section" id="id13">
<h3>Notes<a class="headerlink" href="#id13" title="Permalink to this heading">¶</a></h3>
<p>The feature DataFrame contains the following eleven columns, including the unique
feature id (1), scale information (2-4), statistical results used for filtering and
ranking (5-10), and feature positions (11):</p>
<ol class="arabic simple">
<li><p>features: Feature ID (PART-SPLIT-SCALE)</p></li>
<li><p>category: Scale category</p></li>
<li><p>subcategory: Sub category of scales</p></li>
<li><p>scale_name: Name of scales</p></li>
<li><p>abs_auc: Absolute adjusted AUC [-0.5 to 0.5]</p></li>
<li><p>abs_mean_dif: Absolute mean differences between test and reference group [0 to 1]</p></li>
<li><p>std_test: Standard deviation in test group</p></li>
<li><p>std_ref: Standard deviation in reference group</p></li>
<li><p>p_val: Non-parametric (mann_whitney) or parametric (ttest_indep) statistic</p></li>
<li><p>p_val_fdr_bh: Benjamini-Hochberg FDR corrected p-values</p></li>
<li><p>positions: Feature positions for default settings</p></li>
</ol>
</div>
</dd></dl>

</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="aaanalysis.cpp.SequenceFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aaanalysis.cpp.</span></span><span class="sig-name descname"><span class="pre">SequenceFeature</span></span><a class="reference internal" href="_modules/aaanalysis/cpp/feature.html#SequenceFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SequenceFeature" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and create sequence feature components (Part, Split, and Scale).</p>
<div class="section" id="id14">
<h2>Notes<a class="headerlink" href="#id14" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>Part: Feature Component</dt><dd><p>A continuous subset of a sequence like a protein domain (e.g, transmembrane domain of membrane proteins).</p>
</dd>
<dt>Split: Feature Component</dt><dd><p>Principle to obtain a distinct subset of amino acids from a sequence part like a segment or a pattern.</p>
</dd>
<dt>Scale: Feature Component</dt><dd><p>A physicochemical scale assigning  each amino acid a numerical value between 0 and 1.</p>
</dd>
<dt>Feature: Part + Split + Scale</dt><dd><p>Physicochemical property (expressed as numerical scale) present at distinct amino acid
positions within a protein sequence. The positions are obtained by splitting sequence parts
into segments or patterns.</p>
</dd>
<dt>Feature value: Realization of a Feature</dt><dd><p>For a given sequence, a feature value is the average of a physicochemical scale over
all amino acids obtained by splitting a sequence part.</p>
</dd>
<dt>List of valid sequence parts:</dt><dd><p>[‘tmd’, ‘tmd_e’, ‘tmd_n’, ‘tmd_c’, ‘jmd_n’, ‘jmd_c’, ‘ext_c’, ‘ext_n’,
‘tmd_jmd’, ‘jmd_n_tmd_n’, ‘tmd_c_jmd_c’, ‘ext_n_tmd_n’, ‘tmd_c_ext_c’]</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.SequenceFeature.feat_matrix">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">feat_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_parts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_gaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/feature.html#SequenceFeature.feat_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SequenceFeature.feat_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Create feature matrix for given feature names and sequence parts.</p>
<div class="section" id="id15">
<h3>Parameters<a class="headerlink" href="#id15" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>df_parts: pd.DataFrame</dt><dd><p>DataFrame with sequence parts.</p>
</dd>
<dt>features: str, list of strings, pd.Series</dt><dd><p>Ids of features for which matrix of feature values should be created.</p>
</dd>
<dt>df_scales: pd.DataFrame, optional</dt><dd><p>DataFrame with default amino acid scales.</p>
</dd>
<dt>accept_gaps: bool, default=False</dt><dd><p>Whether to accept missing values by enabling omitting for computations (if True).</p>
</dd>
<dt>verbose: bool, default=True</dt><dd><p>Whether to print size of to be created feature matrix (if True) or not otherwise.</p>
</dd>
<dt>return_labels: bool, default=False</dt><dd><p>Whether to return sample labels in addition to feature matrix.</p>
</dd>
</dl>
</div>
<div class="section" id="id16">
<h3>Returns<a class="headerlink" href="#id16" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>feat_matrix: array-like or sparse matrix, shape (n_samples, n_features)</dt><dd><p>Feature values of samples.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.SequenceFeature.feat_names">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">feat_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_cat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmd_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_c_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_n_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/feature.html#SequenceFeature.feat_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SequenceFeature.feat_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert feature ids (PART-SPLIT-SCALE) into feature name (scale name [positions]).</p>
<div class="section" id="id17">
<h3>Parameters<a class="headerlink" href="#id17" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>features: str, list of strings, pd.Series</dt><dd><p>Ids of features for which feature names should be created.</p>
</dd>
<dt>df_cat: pd.DataFrame, default=SequenceFeature.load_categories</dt><dd><p>DataFrame with default categories for physicochemical amino acid scales</p>
</dd>
<dt>tmd_len: int, &gt;0</dt><dd><p>Length of TMD.</p>
</dd>
<dt>jmd_n_len: int, &gt;0</dt><dd><p>Length of JMD-N.</p>
</dd>
<dt>jmd_c_len: int, &gt;0</dt><dd><p>Length of JMD-C.</p>
</dd>
<dt>ext_len:int, &gt;0</dt><dd><p>Length of TMD-extending part (starting from C and N terminal part of TMD).
Conditions: ext_len&lt;jmd_m_len and ext_len&lt;jmd_c_len</p>
</dd>
<dt>start: int, &gt;=0</dt><dd><p>Position label of first amino acid position (starting at N-terminus).</p>
</dd>
</dl>
</div>
<div class="section" id="id18">
<h3>Returns<a class="headerlink" href="#id18" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>feat_names: list of strings</dt><dd><p>Names of features.</p>
</dd>
</dl>
</div>
<div class="section" id="id19">
<h3>Notes<a class="headerlink" href="#id19" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>Positions are given depending on the three split types</dt><dd><ol class="loweralpha simple">
<li><p>Segment: [first…last]</p></li>
<li><p>Pattern: [all positions]</p></li>
<li><p>PeriodicPattern: [first..step1/step2..last]</p></li>
</ol>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.SequenceFeature.feat_value">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">feat_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_parts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_gaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/feature.html#SequenceFeature.feat_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SequenceFeature.feat_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Create feature values for all sequence parts by combining Part, Split, and Scale.</p>
<div class="section" id="id20">
<h3>Parameters<a class="headerlink" href="#id20" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>df_parts: pd.DataFrame</dt><dd><p>DataFrame with sequence parts.</p>
</dd>
<dt>split: str</dt><dd><p>Name of Split following given convention.</p>
</dd>
<dt>dict_scale: dict</dt><dd><p>Dictionary mapping a numerical value to each letter of given sequences</p>
</dd>
<dt>accept_gaps: bool, default=False</dt><dd><p>Whether to accept missing values by enabling omitting for computations (if True).</p>
</dd>
</dl>
</div>
<div class="section" id="id21">
<h3>Returns<a class="headerlink" href="#id21" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>feature_value: array-like, shape (n_samples, n_parts)</dt><dd><p>Average scale values over sequence parts.</p>
</dd>
</dl>
</div>
<div class="section" id="id22">
<h3>Notes<a class="headerlink" href="#id22" title="Permalink to this heading">¶</a></h3>
<p>A split name should has the form of PART-SPLIT-SCALE, where following structures
are given for the three split types:</p>
<ol class="loweralpha simple">
<li><dl class="simple">
<dt>Segment(i-th,n_split)</dt><dd><p>with i-th&lt;=n_split and
where ‘i-th’ and ‘n_split’ indicate the i-th Segment resp. the number of Segments.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Pattern(N/C,p1,p2,…,pn)</dt><dd><p>with p1&lt;p2&lt;…&lt;pn indicating amino acid positions and
‘N/C’ whether the splits starts from the N resp. C-terminal sequence end.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PeriodicPattern(N/C,i+step1/step2,start)</dt><dd><p>where ‘step1/step2’ indicates the step size of each odd resp. even step and
‘start’ gives the first position starting from the N- or C-terminal sequence end.</p>
</dd>
</dl>
</li>
</ol>
<p>All numbers should be non-negative integers. Examples for each split type
are as follows: ‘Segment(5,7)’, ‘Pattern(C,1,2)’, ‘PeriodicPattern(N,i+2/3,1)’.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.SequenceFeature.features">
<span class="sig-name descname"><span class="pre">features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_parts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_kws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_parts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/feature.html#SequenceFeature.features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SequenceFeature.features" title="Permalink to this definition">¶</a></dt>
<dd><p>Create list of feature ids for given Parts, Splits, and Scales</p>
<div class="section" id="id23">
<h3>Parameters<a class="headerlink" href="#id23" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>list_parts: list of strings (n&gt;=1 parts), default=[“tmd_e”, “jmd_n_tmd_n”, “tmd_c_jmd_c”]</dt><dd><p>Names of sequence parts which should be created (e.g., ‘tmd’).</p>
</dd>
<dt>split_kws: dict, default=SequenceFeature.get_split_kws</dt><dd><p>Nested dictionary with parameter dictionary for each chosen split_type.</p>
</dd>
<dt>df_scales: pd.DataFrame, default=SequenceFeature.load_scales</dt><dd><p>DataFrame with default amino acid scales.</p>
</dd>
<dt>all_parts: bool, default=False</dt><dd><p>Whether to create DataFrame with all possible sequence parts (if True) or parts given by list_parts.</p>
</dd>
</dl>
</div>
<div class="section" id="id24">
<h3>Returns<a class="headerlink" href="#id24" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>features: list of strings</dt><dd><p>Ids of all possible features for combination of Parts, Splits, and Scales with form: PART-SPLIT-SCALE</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.SequenceFeature.get_df_parts">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_df_parts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_seq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_parts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_n_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jmd_c_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_parts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/feature.html#SequenceFeature.get_df_parts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SequenceFeature.get_df_parts" title="Permalink to this definition">¶</a></dt>
<dd><p>Create DataFrane with sequence parts.</p>
<div class="section" id="id25">
<h3>Parameters<a class="headerlink" href="#id25" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>df_seq: pd.DataFrame</dt><dd><p>DataFrame with sequence information comprising either sequence (‘sequence’, ‘tmd_start’, ‘tmd_stop’)
or sequence part (‘jmd_n’, ‘tmd’, ‘jmd_c’) columns.</p>
</dd>
<dt>list_parts: list of string, len&gt;=1</dt><dd><p>Names of sequence parts which should be created (e.g., ‘tmd’).</p>
</dd>
<dt>jmd_n_len: int, default=None, optional</dt><dd><p>Length of JMD-N in number of amino acids. If None, ‘jmd_n’ column must be given in df_seq.</p>
</dd>
<dt>jmd_c_len: int, default=None, optional</dt><dd><p>Length of JMD-N in number of amino acids. If None, ‘jmd_c’ column must be given in df_seq.</p>
</dd>
<dt>ext_len: int, default=4</dt><dd><p>Lenght of N- resp. C-terminal extra part of TMD.</p>
</dd>
<dt>all_parts: bool, default=False</dt><dd><p>Whether to create DataFrame with all possible sequence parts (if True) or parts given by list_parts.</p>
</dd>
</dl>
</div>
<div class="section" id="id26">
<h3>Returns<a class="headerlink" href="#id26" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>df_parts: pd.DataFrame</dt><dd><p>DataFrame with sequence parts.</p>
</dd>
</dl>
</div>
<div class="section" id="id27">
<h3>See Also<a class="headerlink" href="#id27" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>cpp.SequenceFeature</dt><dd><p>A list of valid sequence parts is given in the ‘Notes’ section.</p>
</dd>
</dl>
</div>
<div class="section" id="id28">
<h3>Examples<a class="headerlink" href="#id28" title="Permalink to this heading">¶</a></h3>
<p>Get sequence parts based on parts columns in df_seq with with ‘tmd_e’, and ‘tmd_jmd’ as parts:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aaanalysis</span> <span class="k">as</span> <span class="nn">aa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sf</span> <span class="o">=</span> <span class="n">aa</span><span class="o">.</span><span class="n">SequenceFeature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_seq</span> <span class="o">=</span> <span class="n">aa</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;GSEC_SUB_SEQ&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_parts</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">get_df_parts</span><span class="p">(</span><span class="n">df_seq</span><span class="o">=</span><span class="n">df_seq</span><span class="p">,</span> <span class="n">list_parts</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;tmd_e&quot;</span><span class="p">,</span> <span class="s2">&quot;tmd_jmd&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Get sequence parts based on sequence column in df_seq and jmd_n_len and jmd_c_len with default parts:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aaanalysis</span> <span class="k">as</span> <span class="nn">aa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sf</span> <span class="o">=</span> <span class="n">aa</span><span class="o">.</span><span class="n">SequenceFeature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_seq</span> <span class="o">=</span> <span class="n">aa</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;GSEC_SUB_SEQ&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_parts</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">get_df_parts</span><span class="p">(</span><span class="n">df_seq</span><span class="o">=</span><span class="n">df_seq</span><span class="p">,</span> <span class="n">jmd_n_len</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">jmd_c_len</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.SequenceFeature.get_split_kws">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_split_kws</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_split_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_split_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_pattern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_periodicpattern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/feature.html#SequenceFeature.get_split_kws"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SequenceFeature.get_split_kws" title="Permalink to this definition">¶</a></dt>
<dd><p>Create dictionary with kwargs for three split types: Segment, Pattern, PeriodicPattern</p>
<div class="section" id="id29">
<h3>Parameters<a class="headerlink" href="#id29" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>n_split_min: int, default=1</dt><dd><p>Number greater 0 to specify the greatest Segment (e.g., 1/1 TMD alias whole TMD sequence).</p>
</dd>
<dt>n_split_max: int, default=15,</dt><dd><p>Number greater n_split_min to specfiy the smallest Segment (e.g., 1/15 TMD).</p>
</dd>
<dt>steps_pattern: list of integers, default=[3, 4, 6, 7, 8]</dt><dd><p>Possible steps sizes for Pattern.</p>
</dd>
<dt>n_min: int, default=2</dt><dd><p>Minimum number of steps for Pattern.</p>
</dd>
<dt>n_max: int, default=4</dt><dd><p>Maximum number of steps for Pattern.</p>
</dd>
<dt>len_max: int, default=10</dt><dd><p>Maximum length in amino acid position for Pattern by varying start position.</p>
</dd>
<dt>steps_periodicpattern: list of integers, default=[3, 4]</dt><dd><p>Step sizes for PeriodicPattern.</p>
</dd>
<dt>split_types: list of strings, default=[“Segment”, “Pattern” “PeriodicPattern”]</dt><dd><p>Split types for which paramter dictionary should be generated.</p>
</dd>
</dl>
</div>
<div class="section" id="id30">
<h3>Returns<a class="headerlink" href="#id30" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>split_kws: dict</dt><dd><p>Nested dictionary with parameters for chosen split_types:</p>
<ol class="loweralpha simple">
<li><p>Segment: {n_split_min:1, n_split_max=15}</p></li>
<li><p>Pattern: {steps=[3, 4], n_min=2, n_max=4, len_max=15}</p></li>
<li><p>PeriodicPattern: {steps=[3, 4]}</p></li>
</ol>
</dd>
</dl>
</div>
<div class="section" id="id31">
<h3>Examples<a class="headerlink" href="#id31" title="Permalink to this heading">¶</a></h3>
<p>Get default arguments for all splits types (Segment, Pattern, PeriodicPattern):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aaanalysis</span> <span class="k">as</span> <span class="nn">aa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sf</span> <span class="o">=</span> <span class="n">aa</span><span class="o">.</span><span class="n">SequenceFeature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">split_kws</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">get_split_kws</span><span class="p">()</span>
</pre></div>
</div>
<p>Get default argumetns for Segment split:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">aaanalysis</span> <span class="k">as</span> <span class="nn">aa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sf</span> <span class="o">=</span> <span class="n">aa</span><span class="o">.</span><span class="n">SequenceFeature</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">split_kws</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">get_split_kws</span><span class="p">(</span><span class="n">split_types</span><span class="o">=</span><span class="s2">&quot;Segment&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="aaanalysis.cpp.SplitRange">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aaanalysis.cpp.</span></span><span class="sig-name descname"><span class="pre">SplitRange</span></span><a class="reference internal" href="_modules/aaanalysis/cpp/_split.html#SplitRange"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SplitRange" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for creating range of splits for testing sets of multiple features in CPP</p>
<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.SplitRange.labels_pattern">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">labels_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/_split.html#SplitRange.labels_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SplitRange.labels_pattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Get labels for range of Pattern splits.
Output matches with SequenceFeature.pattern.</p>
<div class="section" id="id32">
<h2>Parameters<a class="headerlink" href="#id32" title="Permalink to this heading">¶</a></h2>
<p>steps: list of integer indicating possible step sizes
n_min: integer indicating minimum of elements in Pattern split
n_min: integer indicating maximum of elements in Pattern split
len_max: maximum of sequence length for splitting</p>
</div>
<div class="section" id="id33">
<h2>Returns<a class="headerlink" href="#id33" title="Permalink to this heading">¶</a></h2>
<p>labels: list of labels of Pattern splits</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.SplitRange.labels_periodicpattern">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">labels_periodicpattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/_split.html#SplitRange.labels_periodicpattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SplitRange.labels_periodicpattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Get labels of all possible PeriodicPattern splits.
Output matches with SequenceFeature.periodicpattern.</p>
<div class="section" id="id34">
<h2>Parameters<a class="headerlink" href="#id34" title="Permalink to this heading">¶</a></h2>
<p>steps: list of integer indicating possible step sizes</p>
</div>
<div class="section" id="id35">
<h2>Returns<a class="headerlink" href="#id35" title="Permalink to this heading">¶</a></h2>
<p>labels: list of labels of Pattern splits</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.SplitRange.labels_segment">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">labels_segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_split_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_split_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/_split.html#SplitRange.labels_segment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SplitRange.labels_segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Get labels for range of Segment splits.
Output matches with SequenceFeature.segment.</p>
<div class="section" id="id36">
<h2>Parameters<a class="headerlink" href="#id36" title="Permalink to this heading">¶</a></h2>
<p>n_split_min: integer indicating minimum Segment size
n_split_max: integer indicating maximum Segment size</p>
</div>
<div class="section" id="id37">
<h2>Returns<a class="headerlink" href="#id37" title="Permalink to this heading">¶</a></h2>
<p>labels: list of labels of Segment splits</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.SplitRange.pattern">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/_split.html#SplitRange.pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SplitRange.pattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Get range of all possible Pattern splits for given sequence.
Output matches with SequenceFeature.labels_pattern.</p>
<div class="section" id="id38">
<h2>Parameters<a class="headerlink" href="#id38" title="Permalink to this heading">¶</a></h2>
<p>seq: sequence (e.g., amino acids sequence for protein)
steps: list of integer indicating possible step sizes
n_min: integer indicating minimum of elements in Pattern split
n_min: integer indicating maximum of elements in Pattern split
len_max: maximum of sequence length for splitting</p>
</div>
<div class="section" id="id39">
<h2>Returns<a class="headerlink" href="#id39" title="Permalink to this heading">¶</a></h2>
<p>seq_splits: list of sequence Pattern splits</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.SplitRange.periodicpattern">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">periodicpattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/_split.html#SplitRange.periodicpattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SplitRange.periodicpattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Get range of all possible PeriodicPattern splits for given sequence.
Output matches with SequenceFeature.labels_periodicpattern.</p>
<div class="section" id="id40">
<h2>Parameters<a class="headerlink" href="#id40" title="Permalink to this heading">¶</a></h2>
<p>seq: sequence (e.g., amino acids sequence for protein)
steps: list of integer indicating possible step sizes</p>
</div>
<div class="section" id="id41">
<h2>Returns<a class="headerlink" href="#id41" title="Permalink to this heading">¶</a></h2>
<p>seq_splits: list of sequence PeriodicPattern splits</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="aaanalysis.cpp.SplitRange.segment">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_split_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_split_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aaanalysis/cpp/_split.html#SplitRange.segment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aaanalysis.cpp.SplitRange.segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Get range of all possible Segment splits for given sequences.
Output matches with SequenceFeature.labels_segment.</p>
<div class="section" id="id42">
<h2>Parameters<a class="headerlink" href="#id42" title="Permalink to this heading">¶</a></h2>
<p>seq: seq: sequence (e.g., amino acids sequence for protein)
n_split_min: integer indicating minimum Segment size
n_split_max: integer indicating maximum Segment size</p>
</div>
<div class="section" id="id43">
<h2>Returns<a class="headerlink" href="#id43" title="Permalink to this heading">¶</a></h2>
<p>seq_splits: list of sequence Segment splits</p>
</div>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="dpulearn.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="aaclust.html" class="btn btn-neutral float-left" title="AAclust Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, Stephan Breimann.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>